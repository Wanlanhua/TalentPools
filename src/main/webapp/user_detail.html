<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="bootstrap-3.3.7-dist/css/bootstrap.css">
    <script src="libs/jquery/jquery.js"></script>
    <script src="bootstrap-3.3.7-dist/js/bootstrap.js"></script>
    <script src="js/GlobalData.js"></script>
    <link rel="stylesheet" type="text/css" href="css/user_info.css">
    <style>
        th {
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row clearfix row-container">
            <table class="table table-bordered">
                <tbody>
                    <caption>
                        <h2>信息登记表</h2>
                    </caption>
                    <tr>
                        <th style="width:13%">姓名</th>
                        <th style="width:13%" id="name"></th>
                        <th style="width:13%">性别</th>
                        <th style="width:13%" id="sex"></th>
                        <th style="width:13%">民族</th>
                        <th style="width:13%" id="nation"></th>
                        <th rowspan="4"><img width="110px" height="130px" src="./images/favicon.png" id="user_image" />
                        </th>
                    </tr>
                    <tr>
                        <th>出生日期</th>
                        <th id="birthdate"></th>
                        <th>身 高</th>
                        <th id="height"></th>
                        <th>体重</th>
                        <th id="weight"></th>
                    </tr>
                    <tr>
                        <th>学历</th>
                        <th id="udegree"></th>
                        <th colspan="2">联系方式</th>
                        <th colspan="2" id="contact"></th>
                    </tr>
                    <tr>
                        <th>身份证号</th>
                        <th colspan="2" id="idcard"></th>
                        <th>工种</th>
                        <th colspan="2" id="workplant"></th>
                    </tr>
                    <tr>
                        <th>现住址</th>
                        <th colspan="2" id="gzd"></th>
                        <th>健康状况</th>
                        <th id="health"></th>
                        <th>婚姻状况</th>
                        <th id="marry"></th>
                    </tr>
                    <!-- 教育背景 -->
                    <tr>
                        <th style="height:100px;vertical-align:middle" rowspan="3" colspan="2">教育背景</th>
                        <th style="vertical-align:middle">起 止 年 月</th>
                        <th style="vertical-align:middle">学 校 名 称</th>
                        <th style="vertical-align:middle">学历</th>
                        <th style="vertical-align:middle">学历获取方式</th>
                        <th style="vertical-align:middle">学校所在地</th>
                    </tr>

                    <tr name="edu">
                        <!-- <th><input type="month" name="month"> - <input type="month" name="month"></th> -->
                        <th id="estartdate"></th>
                        <th id="schoolname"></th>
                        <th id="degree"></th>
                        <th id="takedegree"></th>
                        <th id="schoollocation"></th>
                    </tr>
                    <tr name="edu">
                        <!-- <th><input type="month" name="month"> - <input type="month" name="month"></th> -->
                        <th id="estartdate"></th>
                        <th id="schoolname"></th>
                        <th id="degree"></th>
                        <th id="takedegree"></th>
                        <th id="schoollocation"></th>
                    </tr>
                    <!-- 工作经历 -->
                    <tr>
                        <th style="height:140px;vertical-align:middle" rowspan="5" colspan="2">工作经历</th>
                        <th style="vertical-align:middle">起 止 年 月</th>
                        <th style="vertical-align:middle">工作单位</th>
                        <th style="vertical-align:middle">岗位</th>
                        <th style="vertical-align:middle">离职原因</th>
                        <th style="vertical-align:middle">证明人电话</th>
                    </tr>
                    <tr name="work">
                        <!-- <th><input type="month" name="month"> - <input type="month" name="month"></th> -->
                        <th id="wstartdate"></th>
                        <th id="job"></th>
                        <th id="post"></th>
                        <th id="resignreason"></th>
                        <th id="ztel"></th>
                    </tr>
                    <tr name="work">
                        <!-- <th><input type="month" name="month"> - <input type="month" name="month"></th> -->
                        <th id="wstartdate"></th>
                        <th id="job"></th>
                        <th id="post"></th>
                        <th id="resignreason"></th>
                        <th id="ztel"></th>
                    </tr>
                    <tr name="work">
                        <!-- <th><input type="month" name="month"> - <input type="month" name="month"></th> -->
                        <th id="wstartdate"></th>
                        <th id="job"></th>
                        <th id="post"></th>
                        <th id="resignreason"></th>
                        <th id="ztel"></th>
                    </tr>
                    <tr name="work">
                        <!-- <th><input type="month" name="month"> - <input type="month" name="month"></th> -->
                        <th id="wstartdate"></th>
                        <th id="job"></th>
                        <th id="post"></th>
                        <th id="resignreason"></th>
                        <th id="ztel"></th>
                    </tr>
                    <!-- 培训经历 -->
                    <tr>
                        <th style="height:140px;vertical-align:middle" rowspan="5" colspan="2">培训经历</th>
                        <th style="vertical-align:middle" colspan="2">培训时间</th>
                        <th style="vertical-align:middle" colspan="2">培训机构</th>
                        <th style="vertical-align:middle">培训内容</th>
                    </tr>
                    <tr name="pex">
                        <th colspan="2" id="ptime"></th>
                        <th colspan="2" id="pplace"></th>
                        <th id="pcontent"></th>
                    </tr>
                    <tr name="pex">
                        <th colspan="2" id="ptime"></th>
                        <th colspan="2" id="pplace"></th>
                        <th id="pcontent"></th>
                    </tr>
                    <tr name="pex">
                        <th colspan="2" id="ptime"></th>
                        <th colspan="2" id="pplace"></th>
                        <th id="pcontent"></th>
                    </tr>
                    <tr name="pex">
                        <th colspan="2" id="ptime"></th>
                        <th colspan="2" id="pplace"></th>
                        <th id="pcontent"></th>
                    </tr>
                    <!-- 证书资格 -->
                    <tr>
                        <th style="height:120px;vertical-align:middle" rowspan="5" colspan="2">资格证书</th>
                        <th style="vertical-align:middle" colspan="2">证书名称</th>
                        <th style="vertical-align:middle" colspan="2">颁发机构</th>
                        <th style="vertical-align:middle">颁发时间</th>
                    </tr>
                    <tr name="qua">
                        <th colspan="2" id="qplace"></th>
                        <th colspan="2" id="qname"></th>
                        <th id="qtime"></th>
                    </tr>
                    <tr name="qua">
                        <th colspan="2" id="qplace"></th>
                        <th colspan="2" id="qname"></th>
                        <th id="qtime"></th>
                    </tr>
                    <tr name="qua">
                        <th colspan="2" id="qplace"></th>
                        <th colspan="2" id="qname"></th>
                        <th id="qtime"></th>
                    </tr>
                    <tr name="qua">
                        <th colspan="2" id="qplace"></th>
                        <th colspan="2" id="qname"></th>
                        <th id="qtime"></th>
                    </tr>
                    <!-- 家庭成员情况 -->
                    <tr>
                        <th style="height:120px;vertical-align:middle" rowspan="3" colspan="2">家庭成员情况</th>
                        <th>关系</th>
                        <th>姓名</th>
                        <th colspan="2">工作单位</th>
                        <th colspan="2">联系方式</th>
                    </tr>
                    <tr name="mem">
                        <th id="mlink"></th>
                        <th id="mname"></th>
                        <th colspan="2" id="mworkplace"></th>
                        <th id="mtel"></th>
                    </tr>
                    <tr name="mem">
                        <th id="mlink"></th>
                        <th id="mname"></th>
                        <th colspan="2" id="mworkplace"></th>
                        <th id="mtel"></th>
                    </tr>
                    <!-- 自我评价 -->
                    <tr>
                        <th rowspan="2" colspan="2">自我评价</th>
                        <th colspan="5">个人优点、缺点、专长、工作业绩、爱好、职业规划等</th>
                    </tr>
                    <tr>
                        <th colspan="5" id="selfcheck"></th>
                    </tr>

                    <!-- 公司评价 -->
                    <tr>
                        <th rowspan="2" colspan="2">公司评价</th>
                        <th colspan="5">工作能力、工作态度、工作成绩、成长潜力、品行等。</th>
                    </tr>
                    <tr>
                        <th colspan="5" id="companycheck"></th>
                    </tr>
                </tbody>
            </table>

        </div>
        <div class="row info-border">
            <div class="col-md-6 text-center margin-top">
                <h4>身份证正面</h4>
                <div class="user-image-div image-out-border">

                    <div class="image-in-border">
                        <div class="center-vertical">
                            <img src="" id="image_id_z" alt="" width="290" height="200">
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-md-6 text-center margin-top">
                <h4>身份证反面</h4>
                <div class="user-image-div image-out-border">

                    <div class="image-in-border">
                        <div class="center-vertical">
                            <img src="" id="image_id_f" alt="" width="290" height="200">
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-md-6 text-center margin-top">
                <h4>职业资格证</h4>
                <div class="user-image-div image-out-border">

                    <div class="image-in-border">
                        <div class="center-vertical">
                            <img src="" id="image_career" alt="" width="290" height="200">
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-md-6 text-center margin-top">
                <h4>其他证书</h4>
                <div class="user-image-div image-out-border">

                    <div class="image-in-border">
                        <div class="center-vertical">
                            <img src="" id="image_other1" alt="" width="290" height="200">
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-md-6 text-center margin-top">
                <h4>其他证书</h4>
                <div class="user-image-div image-out-border">

                    <div class="image-in-border">
                        <div class="center-vertical">
                            <img src="" id="image_other2" alt="" width="290" height="200">
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-md-6 text-center margin-top" style="display: none;">
                <h4>工作简历</h4>
                <div class="user-image-div image-out-border">

                    <div class="image-in-border">
                        <div class="center-vertical">
                            <!-- <img src="" id="image_work" alt="" width="290" height="200"> -->
                            <textarea id="resume" class=" center-block form-control " rows="10" style="width: 310px"
                                disabled>
                             </textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div style="text-align: center">
            <Button type="button" id="back" class="next-button inputs">返回
        </div>
</body>
<script>

    var userID;
    //接收页面传值
    window.onload = function () {
        var value;
        var that = this
        var url = window.location.search;
        //接收id
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            var id = str.split("=")[1];
            this.userID = id;
            //得到id进行ajax获取数据
            $.ajax({
                type: "GET",
                url: "/TalentPools/userquery/" + userID,
                dataType: "json",
                data: {
                    "username": userID,
                },
                success: function (res) {
                    console.log(res);

                    //获取基本信息
                    let base = new Map(objToMap(res.userinfo));
                    let trlist = document.getElementsByTagName("tr");
                    for (let i = 0; i < trlist.length; i++) {
                        //获取前五行和后两行
                        if (i < 5 || i > trlist.length - 4) {
                            let thlist = trlist[i].querySelectorAll("th");
                            for (let j = 0; j < thlist.length; j++) {
                                if (thlist[j].id && base.get(thlist[j].id)) {
                                    // thlist[j].innerHTML = base.get(thlist[j].id);
                                    thlist[j].innerHTML = base.get(thlist[j].id);
                                }
                            }
                        }
                    }
                    //设置性别
                    //                   console.log(document.getElementById("sex"));
                    //                   if(base.get("sex") == "man"){
                    //                   	document.getElementById("sex").innerHTML("男");
                    //                   }else{
                    //                  	document.getElementById("sex").innerHTML("女");
                    //                  }

                    //设置教育背景
                    let edu = document.getElementsByName("edu")
                    for (let i = 0; i < edu.length; i++) {
                        let teach = new Map(objToMap(res.edu[i]));
                        console.log(teach);
                        let th = edu[i].querySelectorAll("th");
                        console.log(th);
                        for (let t of th) {
                            if (t.id && teach.get(t.id)) {
                                t.innerHTML = teach.get(t.id);
                            }
                        }
                    }
                    //工作经历
                    let work = document.getElementsByName("work");
                    for (let i = 0; i < work.length; i++) {
                        let teach = new Map(objToMap(res.work[i]));
                        console.log(teach);
                        let th = work[i].querySelectorAll("th");
                        console.log(th);
                        for (let t of th) {
                            if (t.id && teach.get(t.id)) {
                                t.innerHTML = teach.get(t.id);
                            }
                        }
                    }
                    //培训经历
                    let pex = document.getElementsByName("pex");
                    for (let i = 0; i < pex.length; i++) {
                        let teach = new Map(objToMap(res.pex[i]));
                        console.log(teach);
                        let th = pex[i].querySelectorAll("th");
                        console.log(th);
                        for (let t of th) {
                            if (t.id && teach.get(t.id)) {
                                t.innerHTML = teach.get(t.id);
                            }
                        }
                    }
                    //资格证书
                    let qua = document.getElementsByName("qua");
                    for (let i = 0; i < qua.length; i++) {
                        let teach = new Map(objToMap(res.qua[i]));
                        console.log(teach);
                        let th = qua[i].querySelectorAll("th");
                        console.log(th);
                        for (let t of th) {
                            if (t.id && teach.get(t.id)) {
                                t.innerHTML = teach.get(t.id);
                            }
                        }
                    }
                    //家庭成员情况
                    let mem = document.getElementsByName("mem");
                    for (let i = 0; i < mem.length; i++) {
                        let teach = new Map(objToMap(res.mem[i]));
                        console.log(teach);
                        let th = mem[i].querySelectorAll("th");
                        console.log(th);
                        for (let t of th) {
                            if (t.id && teach.get(t.id)) {
                                t.innerHTML = teach.get(t.id);
                            }
                        }
                    }
                    //工作简历
                    $("#resume").val(res.userinfo.resume);
                    // 改变图片内容 
                    $("#user_image").attr("src", 'pic/' + res.userinfo.head);
                    $("#image_id_z").attr("src", 'pic/' + res.userinfo.idcardphotoz);
                    $("#image_id_f").attr("src", 'pic/' + res.userinfo.idcardphotof);
                    $("#image_career").attr("src", 'pic/' + res.userinfo.jobphoto);
                    $("#image_other1").attr("src", 'pic/' + res.userinfo.otherphoto1);
                    $("#image_other2").attr("src", 'pic/' + res.userinfo.otherphoto2);
                },
                error: function (jqXHR) {
                    console.log("Error: " + jqXHR.status);
                }
            });
        }

        document.getElementById('back').addEventListener('click', () => {
            history.go(-1);
        })
    }
    // 对象转化为map
    function objToMap(obj) {
        let map = new Map();
        if (obj) {
            for (let k of Object.keys(obj)) {
                map.set(k, obj[k]);
            }
            return map;
        }

    }

</script>


</html>