<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!-- <link rel="Bookmark" href="/favicon.ico" >
<link rel="Shortcut Icon" href="/favicon.ico" /> -->


<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="libs/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<link href="https://cdn.bootcss.com/bootstrap-select/1.12.1/css/bootstrap-select.min.css" rel="stylesheet">
<script src="js/jquery-3.3.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap-select/1.12.1/js/bootstrap-select.min.js"></script>


<title>添加操作员</title>
</head>
<body>
<article class="page-container">
	<form action="" method="post" class="form form-horizontal" id="form-operator-add">
		<!-- <div class="row cl">
			<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>用户名：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="username" name="username">
			</div>
		</div> -->
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>姓名：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="name" name="name">
			</div>
        </div>
        <div class="row cl">
			<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>密码：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="password" name="password">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-3">联系方式：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="contact" name="tel">
			</div>
        </div>
        
        <!-- <div class="row cl">
			<label class="form-label col-xs-4 col-sm-3">部门：</label>
			<div class="formControls col-xs-8 col-sm-9"> <span class="select-box">
				<select class="select" size="1" name="city" id="department">
					<option value="财务部">财务部</option>
					<option value="技术部">技术部</option>
					<option value="营销部">营销部</option>
				</select>
				</span> </div>
		</div> -->
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-3">管理区域：</label>
			<div class="formControls col-xs-8 col-sm-9"> 
				<select id="area" class="selectpicker show-menu-arrow form-control" multiple>
					<option value="北京市">北京市</option>
					<option value="天津市">天津市</option>
					<option value="上海市">上海市</option>
					<option value="重庆市">重庆市</option>
					<option value="河北省">河北省</option>
					<option value="山西省">山西省</option>
					<option value="辽宁省">辽宁省</option>
					<option value="吉林省">吉林省</option>
					<option value="黑龙江省">黑龙江省</option>
					<option value="江苏省">江苏省</option>
					<option value="浙江省">浙江省</option>
					<option value="安徽省">安徽省</option>
					<option value="福建省">福建省</option>
					<option value="江西省">江西省</option>
					<option value="山东省">山东省</option>
					<option value="河南省">河南省</option>
					<option value="湖北省">湖北省</option>
					<option value="湖南省">湖南省</option>
					<option value="广东省">广东省</option>
					<option value="海南省">海南省</option>
					<option value="四川省">四川省</option>
					<option value="贵州省">贵州省</option>
					<option value="云南省">云南省</option>
					<option value="陕西省">陕西省</option>
					<option value="甘肃省">甘肃省</option>
					<option value="青海省">青海省</option>
					<option value="台湾省">台湾省</option>
					<option value="内蒙古自治区">内蒙古自治区</option>
					<option value="广西壮族自治区">广西壮族自治区</option>
					<option value="西藏自治区">西藏自治区</option>
					<option value="宁夏回族自治区">宁夏回族自治区</option>
					<option value="新疆维吾尔自治区">新疆维吾尔自治区</option>
					<option value="香港特别行政区">香港特别行政区</option>
					<option value="澳门特别行政区">澳门特别行政区</option>
				</select>
			</div>
		</div>
		<div class="row cl">
			<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
				<input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;保存&nbsp;&nbsp;">
			</div>
		</div>
	</form>
</article>

<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="libs/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="libs/layer/2.4/layer.js"></script>
<script type="text/javascript" src="static/h-ui/js/H-ui.min.js"></script> 
<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.js"></script>

<!--请在下方写此页面业务相关的脚本--> 
<script type="text/javascript" src="libs/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="libs/jquery.validation/1.14.0/jquery.validate.js"></script> 
<script type="text/javascript" src="libs/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" src="libs/jquery.validation/1.14.0/messages_zh.js"></script>
<script type="text/javascript">

//编辑操作员传值
var username = "";
var name = "";
var password = "";
var contact = "";
var area = "";
var id = "";
window.onload = function () {
	
	
}

$(function(){
	var url=location.search;  //"?username=gdf&password=gfg"
	var Request = new Object();
	if(url.indexOf("?")!=-1)
	{
	　　var str = url.substr(1);　//截取?之后的字符串
	　　strs= str.split("&");//将字符串以符号"&"分隔成两段
	　　for(var i = 0; i < strs.length; i++)
	　　{
	　　 　 Request[strs[i].split("=")[0]] = decodeURI(strs[i].split("=")[1]);//将每一段字符串又以"="分为两段
	　　}
	}
	
	
	username =Request["username"];
	
	name = Request["name"];
	password = Request["password"];
	contact = Request["contact"];
	area = Request["area"];
	id = Request["id"];
	//console.log("页面传值"+area) 
	//将数据填充到表中
	$('#name').val(name)
	$('#password').val(password)
	$('#contact').val(contact)
	//$('#area').val(area)
	//alert("无语"+area);
	
	if(area!="")
	{
		var areas=area.split(",");
		for(var i=0;i<areas.length;i++)
		{
			//console.log("i:"+i);
			var temp=new Array("北京市","天津市","上海市","重庆市","河北省","山西省",
					           "辽宁省","吉林省","黑龙江省","江苏省","浙江省","安徽省",
					           "福建省","江西省","山东省","河南省","湖北省","湖南省",
					           "广东省","海南省","四川省","贵州省","云南省","陕西省",
					           "甘肃省","青海省","台湾省","内蒙古自治区","广西壮族自治区",
					           "西藏自治区","宁夏回族自治区","新疆维吾尔自治区","香港特别行政区","澳门特别行政区");
			for(var j=0;j<temp.length;j++)
			{
				//console.log("j:"+j+temp[j]+""+areas[i]);
				if(temp[j]==areas[i])
				{
					//console.log("j:"+j+temp[j]+""+areas[i]);
					document.getElementById("area")[j].selected=true;
				}
			}
		}
	}
	
	//表单验证
	$("#form-operator-add").validate({
		rules:{
			name:{
				required:true,
			},
			password:{
				required:true,
			},	
		},
		onkeyup:false,
		focusCleanup:true,
		success:"valid",
		submitHandler:function(form){
			var from = document.getElementById("form-operator-add")
			var name = from.elements[0].value;
			var password = from.elements[1].value;
			var contact = form.elements[2].value;

			var area = $('#area').val();
			console.log("管理区域"+area)
			if(area==null){
				layer.msg("管理区域为原始默认值进行保存")
				var area1 = "null";
			}else{
				var arealength = $('#area').val().length;
				var areaArray = new Array(arealength);
				for(var i=0;i<arealength;i++){
					areaArray[i]=$('#area').val()[i];
					area1 = areaArray.join();
					//console.log("管理区域"+areaArray[i])
				}
				//console.log(name+password+contact+areaArray.join())
			}
			//上传服务器
			$.post("/TalentPools/opUpdate",{
				username:username,   //用户名
				name:name,			//姓名
				password:password,	//密码
				contact:contact,	//联系方式
				area:area1,  			//管理区域
				id:id
			},
			function(data,status){
				if(status == "success"){
					console.log(data)
					if(data=='1'){
						parent.window.location='admin-list.html';
						
						//var index = parent.layer.getFrameIndex(window.name); 
						//parent.$('#btn-refresh').click();
						//parent.layer.close(index);  
						layer.msg("修改成功！")
					}else if(data=='0'){
						layer.msg("修改失败！")
					}else{
						layer.msg("服务器错误！")
					}
				}else{
					layer.msg("请检查网络连接")
				}
			});
		}
	});
});
</script> 
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>